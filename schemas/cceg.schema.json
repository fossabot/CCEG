{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://cceg.datasets/v1/schema",
  "title": "Cloud Compliance Execution Graph (CCEG) Schema",
  "version": "1.0.0",
  "description": "Synthetic dataset schema for ML-powered cloud compliance automation",
  "type": "object",
  "required": ["record_id"],
  "properties": {
    "record_id": {
      "type": "string",
      "description": "Unique record identifier",
      "pattern": "^(INT|EXEC|REMED)_[0-9]{6}$"
    },
    "control_family": {
      "type": "string",
      "enum": ["AC", "AU", "CM", "IA", "SC", "SI", "RA", "PL"],
      "description": "NIST-inspired control family (abstracted)"
    },
    "control_intent_vector": {
      "type": "object",
      "required": ["objective", "asset_class", "risk_domain"],
      "properties": {
        "objective": {
          "type": "string",
          "description": "Primary security objective"
        },
        "asset_class": {
          "type": "string",
          "enum": ["identity", "compute", "storage", "network", "data", "management"],
          "description": "Cloud asset classification"
        },
        "risk_domain": {
          "type": "string",
          "description": "Risk category this control addresses"
        }
      }
    },
    "abstraction_level": {
      "type": "string",
      "const": "vendor_neutral"
    },
    "standard_mappings": {
      "type": "object",
      "properties": {
        "nist_800_53": {"type": "string"},
        "cis": {"type": "string"},
        "iso_27001": {"type": "string"}
      }
    },
    "cloud_context": {
      "type": "object",
      "required": ["provider", "service", "resource_type"],
      "properties": {
        "provider": {
          "type": "string",
          "const": "aws"
        },
        "service": {
          "type": "string",
          "description": "AWS service name"
        },
        "resource_type": {
          "type": "string",
          "pattern": "^aws_[a-z_]+$"
        },
        "region": {
          "type": "string"
        }
      }
    },
    "infrastructure_pattern": {
      "type": "object",
      "required": ["pattern_id", "pattern_class", "pattern_complexity"],
      "properties": {
        "pattern_id": {
          "type": "string"
        },
        "pattern_class": {
          "type": "string"
        },
        "pattern_complexity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "compliance_state": {
      "type": "object",
      "required": ["status", "confidence"],
      "properties": {
        "status": {
          "type": "string",
          "enum": ["compliant", "non_compliant", "partially_compliant"]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "violation_mechanics": {
      "type": "object",
      "required": ["failure_mode", "attack_surface", "blast_radius_score"],
      "properties": {
        "failure_mode": {
          "type": "string"
        },
        "attack_surface": {
          "type": "string"
        },
        "blast_radius_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "evidence_model": {
      "type": "object",
      "required": ["terraform_signal", "runtime_signal", "static_detectable"],
      "properties": {
        "terraform_signal": {
          "type": "string"
        },
        "runtime_signal": {
          "type": "string"
        },
        "static_detectable": {
          "type": "boolean"
        }
      }
    },
    "labeling": {
      "type": "object",
      "properties": {
        "severity": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"]
        },
        "ml_use_case": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "problem_pattern": {
      "type": "object",
      "properties": {
        "pattern_id": {"type": "string"},
        "failure_mode": {"type": "string"},
        "affected_resource": {"type": "string"}
      }
    },
    "remediation_logic": {
      "type": "object",
      "properties": {
        "strategy": {"type": "string"},
        "automation_feasible": {"type": "boolean"},
        "estimated_fix_effort": {
          "type": "string",
          "enum": ["low", "medium", "high"]
        },
        "implementation_steps": {
          "type": "array",
          "items": {"type": "string"}
        },
        "verification_checks": {
          "type": "array",
          "items": {"type": "string"}
        },
        "rollback_complexity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "cost_impact": {
      "type": "object",
      "properties": {
        "aws_cost_delta": {"type": "number"},
        "operational_overhead": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "risk_reduction_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "ai_training_signals": {
      "type": "object",
      "properties": {
        "can_autofix": {"type": "boolean"},
        "requires_approval": {"type": "boolean"},
        "context_complexity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "generated_at": {
      "type": "string",
      "format": "date-time"
    }
  }
}
